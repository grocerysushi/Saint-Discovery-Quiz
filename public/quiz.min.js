const questions=[{id:1,question:"When facing a difficult problem, what is your first instinct?",answers:[{text:"Study and research until I fully understand every aspect",traits:["intellectual","wisdom","contemplation"]},{text:"Take immediate action to address the situation",traits:["leadership","courage","activism"]},{text:"Pray and reflect, trusting that guidance will come",traits:["faith","contemplation","mysticism"]},{text:"Reach out to help others who may be affected",traits:["service","compassion","charity"]}]},{id:2,question:"How do you find the most meaning in your daily life?",answers:[{text:"Through quiet moments of prayer and reflection",traits:["contemplation","prayer","mysticism"]},{text:"By serving others and meeting their needs",traits:["service","charity","compassion"]},{text:"Through learning, reading, and expanding my understanding",traits:["intellectual","wisdom","teaching"]},{text:"By creating beauty in the world through art, music, or nature",traits:["arts","nature","poetry"]}]},{id:3,question:"When you see someone being treated unfairly, how do you respond?",answers:[{text:"Speak up immediately, even if it's uncomfortable",traits:["courage","conviction","justice"]},{text:"Quietly support the person and offer help privately",traits:["compassion","humility","service"]},{text:"Work to change systems and structures that cause injustice",traits:["leadership","reform","activism"]},{text:"Pray for the situation and all involved",traits:["faith","prayer","intercession"]}]},{id:4,question:"What type of environment helps you feel closest to God?",answers:[{text:"In nature - forests, mountains, or near water",traits:["nature","simplicity","animals"]},{text:"In a quiet chapel or during adoration",traits:["contemplation","prayer","mysticism"]},{text:"While actively serving others in need",traits:["service","charity","healing"]},{text:"In community with others, sharing faith together",traits:["community","preaching","evangelization"]}]},{id:5,question:"How would you describe your approach to personal challenges?",answers:[{text:"I persevere steadily, trusting it will work out in time",traits:["perseverance","patience","hope"]},{text:"I face them head-on with determination and courage",traits:["endurance","strength","heroism"]},{text:"I look for lessons and growth opportunities in every trial",traits:["transformation","seeking","introspection"]},{text:"I offer up my suffering and unite it with Christ's",traits:["sacrifice","mysticism","devotion"]}]},{id:6,question:"What role do you naturally take in a group setting?",answers:[{text:"The leader who organizes and guides others",traits:["leadership","organization","discipline"]},{text:"The quiet supporter who ensures everyone's needs are met",traits:["service","humility","generosity"]},{text:"The teacher or mentor who shares knowledge",traits:["teaching","mentorship","wisdom"]},{text:"The encourager who brings joy and peace",traits:["joy","peace","community"]}]},{id:7,question:"What draws you most when learning about a saint's life?",answers:[{text:"Their intellectual contributions and writings",traits:["intellectual","writing","philosophy"]},{text:"Their courage in the face of persecution",traits:["courage","faith","conviction"]},{text:"Their humble service to the poor and suffering",traits:["service","charity","humility"]},{text:"Their deep mystical prayer life and visions",traits:["mysticism","contemplation","prayer"]}]},{id:8,question:"How do you prefer to express your faith?",answers:[{text:"Through studying Scripture and Church teachings",traits:["intellectual","wisdom","teaching"]},{text:"Through works of mercy and charitable actions",traits:["charity","service","compassion"]},{text:"Through contemplative prayer and silence",traits:["contemplation","mysticism","prayer"]},{text:"Through sharing my faith with others openly",traits:["missionary","preaching","courage"]}]},{id:9,question:"What is your greatest strength?",answers:[{text:"My ability to understand complex ideas and explain them clearly",traits:["intellectual","teaching","wisdom"]},{text:"My compassion and desire to help those who are suffering",traits:["compassion","service","healing"]},{text:"My courage to stand firm in my beliefs no matter the cost",traits:["courage","conviction","faith"]},{text:"My patience and ability to trust in God's timing",traits:["patience","perseverance","hope"]}]},{id:10,question:"Which of these callings resonates most with you?",answers:[{text:"Bringing the Gospel to people who haven't heard it",traits:["missionary","evangelization","adventure"]},{text:"Creating a haven of peace and prayer",traits:["contemplation","peace","balance"]},{text:"Standing up for truth in public life",traits:["conviction","justice","activism"]},{text:"Caring for the sick, poor, or marginalized",traits:["service","healing","charity"]}]},{id:11,question:"How do you handle times when your faith is tested?",answers:[{text:"I dig deeper into study and seek understanding",traits:["intellectual","wisdom","faith"]},{text:"I increase my prayer and time in silence with God",traits:["contemplation","prayer","perseverance"]},{text:"I reach out to serve others, finding purpose in giving",traits:["service","charity","love"]},{text:"I hold fast to what I believe, trusting through darkness",traits:["faith","courage","hope"]}]},{id:12,question:"What legacy would you most want to leave behind?",answers:[{text:"Writings or teachings that help others understand the faith",traits:["intellectual","writing","teaching"]},{text:"A community or organization that serves those in need",traits:["service","charity","leadership"]},{text:"The example of a life lived with courage and conviction",traits:["courage","faith","conviction"]},{text:"Having inspired others through simple acts of love",traits:["love","humility","simplicity"]}]}],deepDiveQuestions=[{id:13,question:"How do you approach Sacred Scripture and spiritual reading?",answers:[{text:"I study it deeply, analyzing context and theology",traits:["intellectual","wisdom","teaching"]},{text:"I meditate on it slowly, letting it speak to my heart",traits:["contemplation","mysticism","prayer"]},{text:"I look for practical ways to apply it in daily life",traits:["service","simplicity","obedience"]},{text:"I share insights with others to inspire their faith",traits:["preaching","evangelization","teaching"]}]},{id:14,question:"When you experience suffering or hardship, what is your response?",answers:[{text:"I offer it up as a sacrifice united with Christ's passion",traits:["sacrifice","mysticism","devotion"]},{text:"I see it as an opportunity to grow in virtue and holiness",traits:["transformation","perseverance","strength"]},{text:"I use it to deepen my compassion for others who suffer",traits:["compassion","empathy","service"]},{text:"I trust that God will bring good from it in His time",traits:["faith","hope","patience"]}]},{id:15,question:"What is your relationship with material possessions?",answers:[{text:"I embrace radical poverty and simplicity",traits:["poverty","simplicity","detachment"]},{text:"I use resources generously to help those in need",traits:["charity","generosity","service"]},{text:"I'm grateful for what I have but not attached to it",traits:["gratitude","balance","humility"]},{text:"I see them as tools to serve God's kingdom",traits:["stewardship","wisdom","leadership"]}]},{id:16,question:"How do you relate to authority in the Church and society?",answers:[{text:"I obey faithfully, trusting in God's order",traits:["obedience","humility","faith"]},{text:"I respectfully challenge when I see injustice",traits:["courage","justice","conviction"]},{text:"I work within structures to bring about reform",traits:["reform","leadership","wisdom"]},{text:"I submit while maintaining my own discernment",traits:["balance","wisdom","integrity"]}]},{id:17,question:"What motivates you to share your faith with others?",answers:[{text:"A burning desire to bring souls to Christ",traits:["missionary","evangelization","zeal"]},{text:"The example of my life speaking louder than words",traits:["witness","simplicity","humility"]},{text:"Teaching others to understand the beauty of truth",traits:["teaching","intellectual","wisdom"]},{text:"Showing Christ's love through acts of service",traits:["service","charity","compassion"]}]},{id:18,question:"When you face criticism or opposition for your beliefs, how do you respond?",answers:[{text:"I stand firm with courage, even if it costs me everything",traits:["courage","conviction","martyrdom"]},{text:"I respond with gentleness and prayer for my critics",traits:["humility","patience","forgiveness"]},{text:"I engage intellectually to defend the truth",traits:["intellectual","apologetics","wisdom"]},{text:"I accept it as a cross and offer it to God",traits:["sacrifice","patience","faith"]}]},{id:19,question:"How do you balance action and contemplation in your spiritual life?",answers:[{text:"Contemplation is the foundation; action flows from it",traits:["contemplation","mysticism","prayer"]},{text:"Active service is my primary prayer",traits:["service","charity","action"]},{text:"I strive for equal balance between both",traits:["balance","wisdom","integration"]},{text:"I alternate between seasons of each as God calls",traits:["discernment","flexibility","obedience"]}]},{id:20,question:"Do you prefer community life or solitude in your spiritual journey?",answers:[{text:"I thrive in community, finding God in fellowship",traits:["community","fraternity","collaboration"]},{text:"I need solitude and silence to encounter God deeply",traits:["solitude","contemplation","hermit"]},{text:"I value both, seeking balance between them",traits:["balance","wisdom","integration"]},{text:"I prefer small, intimate communities",traits:["family","intimacy","friendship"]}]},{id:21,question:"How did you recognize and respond to God's call in your life?",answers:[{text:"Through a dramatic conversion or clear moment",traits:["transformation","conversion","calling"]},{text:"Gradually, through prayer and discernment over time",traits:["discernment","patience","listening"]},{text:"Through the needs I saw around me",traits:["service","compassion","responsiveness"]},{text:"Through study and understanding of God's will",traits:["intellectual","wisdom","seeking"]}]},{id:22,question:"What is your relationship with Mary and the saints?",answers:[{text:"Deep devotion, especially to Mary as spiritual mother",traits:["devotion","marian","intercession"]},{text:"I see them as examples and companions on the journey",traits:["communion","friendship","inspiration"]},{text:"I study their lives to learn from their wisdom",traits:["intellectual","learning","wisdom"]},{text:"I ask for their prayers and intercession regularly",traits:["prayer","intercession","trust"]}]},{id:23,question:"How do you approach penance and self-discipline?",answers:[{text:"I embrace rigorous fasting and mortification",traits:["asceticism","discipline","sacrifice"]},{text:"I practice moderation and balance in all things",traits:["temperance","balance","wisdom"]},{text:"I focus on interior conversion more than external acts",traits:["interiority","transformation","heart"]},{text:"I offer small daily sacrifices with love",traits:["littleway","simplicity","love"]}]},{id:24,question:"What is your vision for the Church and the world?",answers:[{text:"Renewal through return to tradition and orthodoxy",traits:["tradition","reform","faithfulness"]},{text:"Transformation through social justice and mercy",traits:["justice","mercy","activism"]},{text:"Evangelization reaching every nation and culture",traits:["missionary","evangelization","universal"]},{text:"Deeper holiness and sanctity in all believers",traits:["holiness","sanctification","perfection"]}]}];let activeQuestions=questions,quizMode="standard",currentQuestion=0,userAnswers=[],matchedSaint=null,matchExplanation="";function selectQuizMode(e){quizMode=e,document.querySelectorAll(".mode-option").forEach(e=>{e.classList.remove("selected")}),document.querySelector(`[data-mode="${e}"]`).classList.add("selected");const t="standard"===e?"12 Thoughtful Questions":"24 In-Depth Questions",i=document.getElementById("featureQuestions");i&&(i.textContent=t)}function initSaintOfTheDay(){if(!document.getElementById("saintOfDay")||"undefined"==typeof saintsDatabase)return;const e=new Date,t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]+" "+e.getDate(),i=saintsDatabase.filter(e=>e.feastDay===t);let a;if(i.length>0)a=i[e.getFullYear()%i.length];else{const t=Math.floor((e-new Date(e.getFullYear(),0,0))/864e5)%saintsDatabase.length;a=saintsDatabase[t]}const n=e.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});document.getElementById("sotdDate").textContent=n,document.getElementById("sotdName").textContent=a.name,document.getElementById("sotdFeast").textContent=`Feast Day: ${a.feastDay}`,document.getElementById("sotdKnown").textContent=a.knownFor;const o=document.getElementById("sotdQuote");a.quote&&a.quote.trim()?o.textContent=`"${a.quote}"`:o.textContent=""}function startQuiz(){activeQuestions="deepdive"===quizMode?[...questions,...deepDiveQuestions]:questions,currentQuestion=0,userAnswers=[],showScreen("quiz"),renderQuestion()}function renderQuestion(){const e=activeQuestions[currentQuestion],t=document.getElementById("questionContainer"),i=currentQuestion/activeQuestions.length*100;document.getElementById("progressFill").style.width=`${i}%`,document.getElementById("progressText").textContent=`Question ${currentQuestion+1} of ${activeQuestions.length}`,t.innerHTML=`\n        <div class="question" key="${e.id}">\n            <h2>${e.question}</h2>\n            <div class="answers">\n                ${e.answers.map((e,t)=>`\n                    <button class="answer-btn" onclick="selectAnswer(${t})">\n                        ${e.text}\n                    </button>\n                `).join("")}\n            </div>\n        </div>\n    `,t.style.animation="none",t.offsetHeight,t.style.animation="slideIn 0.4s ease"}function selectAnswer(e){const t=activeQuestions[currentQuestion];userAnswers.push({questionId:t.id,answerIndex:e,traits:t.answers[e].traits}),currentQuestion++,currentQuestion<activeQuestions.length?renderQuestion():showScreen("userInfo")}function calculateMatch(e){const t=[];userAnswers.forEach(e=>{t.push(...e.traits)});const i={};t.forEach(e=>{i[e]=(i[e]||0)+1});const a={},n=saintsDatabase.filter(t=>t.gender===e);n.forEach(e=>{e.traits.forEach(e=>{a[e]=(a[e]||0)+1})});const o=.4*n.length,s=Object.keys(a).filter(e=>a[e]>o),r=Object.entries(i).sort((e,t)=>t[1]-e[1]),c={};r.forEach(([e,t])=>{Object.keys(traitCategories).forEach(i=>{traitCategories[i].includes(e)&&(c[i]=(c[i]||0)+t)})});const h=Object.entries(c).sort((e,t)=>t[1]-e[1]).slice(0,3).map(([e])=>e);console.log("User Top Traits:",r.slice(0,5).map(([e,t])=>`${e}(${t})`)),console.log("User Top Categories:",h);const l=n.map(e=>{let t=0,a=0,n=0,o=0;e.traits.forEach(e=>{if(i[e]){const n=i[e],r=s.includes(e);t+=2*n*(r?1:2),a++,r||o++}}),e.traits.forEach(e=>{Object.keys(traitCategories).forEach(i=>{if(traitCategories[i].includes(e)&&h.includes(i)){const e=3-h.indexOf(i);t+=1.5*e,n++}})}),a>=3&&(t+=1.5*a),o>0&&(t+=3*o);const r=a/e.traits.length;return r>.5&&(t+=5*r),{saint:e,score:t,directMatches:a,categoryMatches:n,rareMatches:o}});l.sort((e,t)=>t.score-e.score),console.log("Top 5 Candidates:"),l.slice(0,5).forEach((e,t)=>{console.log(`${t+1}. ${e.saint.name} - Score: ${e.score.toFixed(1)} (Direct: ${e.directMatches}, Rare: ${e.rareMatches})`)});const u=l[0].score,d=l.filter(e=>e.score>=.8*u);let m;d.length>1?(d.sort((e,t)=>{const i=5*e.directMatches+3*e.rareMatches+10*Math.random();return 5*t.directMatches+3*t.rareMatches+10*Math.random()-i}),m=d[0]):m=l[0],console.log("Selected Saint:",m.saint.name),matchedSaint=m.saint,matchExplanation=generateExplanation(i,matchedSaint)}function generateExplanation(e,t){const i=Object.entries(e).sort((e,t)=>t[1]-e[1]).slice(0,4).map(([e])=>e),a={intellectual:"intellectual curiosity",contemplation:"contemplative nature",service:"heart for service",leadership:"leadership qualities",courage:"courage and conviction",faith:"deep faith",compassion:"compassionate spirit",humility:"humble approach",wisdom:"pursuit of wisdom",mysticism:"mystical spirituality",prayer:"devotion to prayer",charity:"charitable heart",teaching:"gift for teaching",perseverance:"perseverance through trials",love:"capacity for love",transformation:"openness to transformation",hope:"spirit of hope",missionary:"missionary zeal",nature:"love of nature",justice:"passion for justice"};let n=`Your responses reveal a beautiful combination of ${i.filter(e=>a[e]).map(e=>a[e]).slice(0,3).join(", ")}.`;const o={"St. Francis of Assisi":"Like St. Francis, you find God in simplicity and nature, and your compassion extends to all of creation.","St. Thomas Aquinas":"Like St. Thomas Aquinas, you seek to understand faith through reason and share that understanding with others.","St. John of the Cross":"Like St. John of the Cross, you seek deep union with God through contemplative prayer and are not afraid of spiritual darkness.","St. Ignatius of Loyola":"Like St. Ignatius, you approach faith with discipline and discernment, seeking to find God in all things.","St. Vincent de Paul":"Like St. Vincent, you see Christ in the poor and organize practical ways to serve them.","St. Augustine of Hippo":"Like St. Augustine, your journey has been one of searching, transformation, and ultimately finding rest in God.","St. Maximilian Kolbe":"Like St. Maximilian, you understand that true love means sacrifice, even to the point of giving everything.","St. John Paul II":"Like St. John Paul II, you combine intellectual depth with pastoral warmth and a heart for youth.","St. Padre Pio":"Like Padre Pio, your faith is marked by deep prayer and the gift of accompanying others in their spiritual struggles.","St. Thomas More":"Like St. Thomas More, you understand that faith and integrity must guide all aspects of life, even public service.","St. Martin de Porres":"Like St. Martin, you serve with humble joy, seeing no task as beneath you when it helps others.","St. Peter":"Like St. Peter, you have the heart of a leader who, despite human weakness, remains steadfast in faith.","St. Paul":"Like St. Paul, you have a missionary heart and the gift of communicating the faith to others.","St. Joseph":"Like St. Joseph, you find holiness in quiet faithfulness, hard work, and protecting those you love.","St. Patrick":"Like St. Patrick, you have the courage to bring light to dark places and persevere through hardship.","St. Benedict":"Like St. Benedict, you understand the importance of balance, discipline, and community in the spiritual life.","St. Francis Xavier":"Like St. Francis Xavier, you have an adventurous spirit and desire to share the Gospel across boundaries.","St. Anthony of Padua":"Like St. Anthony, you have gifts for teaching and helping others find what they have lost.","St. John Bosco":"Like St. John Bosco, you have a joyful heart for young people and creative approaches to education.","St. Nicholas":"Like St. Nicholas, your generous heart delights in giving secretly and caring for those in need.","St. George":"Like St. George, you face challenges with courage and stand as a protector of the vulnerable.","St. Sebastian":"Like St. Sebastian, you have the strength to endure trials and remain faithful through persecution.","St. Dominic":"Like St. Dominic, you combine intellectual pursuit with deep prayer and a love for preaching truth.","St. Bernard of Clairvaux":"Like St. Bernard, you blend contemplative depth with influential leadership and reform.","St. Lawrence":"Like St. Lawrence, you serve with joy and courage, seeing the poor as the true treasures of the Church.","St. Jude Thaddeus":"Like St. Jude, you bring hope to hopeless situations and persist in faithful intercession.","St. John Vianney":"Like the Cure of Ars, you find holiness in humble service and tireless dedication to souls.","St. Michael the Archangel":"Like St. Michael, you stand firm against evil and fight for justice and truth.","St. Raphael the Archangel":"Like St. Raphael, you are a healer and guide, bringing God's comfort to those who journey.","St. Teresa of Calcutta":"Like Mother Teresa, your heart aches for those who suffer, and you find Christ in serving the poorest of the poor.","St. Joan of Arc":"Like St. Joan, you have the courage to stand firm in your convictions, even when facing opposition.","St. Therese of Lisieux":"Like the Little Flower, you understand that small acts of love can transform the world.","St. Teresa of Avila":"Like St. Teresa, you combine deep mystical prayer with practical action and reform.","St. Catherine of Siena":"Like St. Catherine, you combine contemplative prayer with bold action for the good of the Church.","St. Elizabeth of Hungary":"Like St. Elizabeth, your noble spirit is expressed through radical generosity to the poor.","St. Mary Magdalene":"Like St. Mary Magdalene, you are a devoted follower who has experienced the transforming power of Christ's love.","St. Clare of Assisi":"Like St. Clare, you embrace simplicity and poverty while remaining steadfast in contemplative prayer.","St. Scholastica":"Like St. Scholastica, you value deep spiritual friendship and devoted community life.","St. Cecilia":"Like St. Cecilia, you use your gifts to glorify God and remain faithful even unto death.","St. Bernadette":"Like St. Bernadette, you approach God with childlike simplicity and humble obedience.","St. Edith Stein":"Like St. Edith Stein, you combine intellectual depth with contemplative spirituality and courageous witness.","St. Faustina Kowalska":"Like St. Faustina, you are a vessel of God's mercy, called to spread trust in His divine love.","St. Gianna Molla":"Like St. Gianna, you understand that love sometimes requires the ultimate sacrifice for those we cherish.","St. Rose of Lima":"Like St. Rose, you find beauty in hidden devotion and mystical union with God.","St. Rita of Cascia":"Like St. Rita, you persevere through impossible situations and find hope in forgiveness.","St. Monica":"Like St. Monica, your persistent prayer and patient faith can move mountains.","St. Anne":"Like St. Anne, you nurture faith in those entrusted to your care with patient, steadfast love.","St. Dymphna":"Like St. Dymphna, you bring comfort and healing to those who suffer in mind and spirit.","St. Louise de Marillac":"Like St. Louise, you combine organizational skill with compassionate service to those in need.","St. Bridget of Sweden":"Like St. Bridget, you receive divine insights and courageously share them for the good of the Church.","St. Margaret of Scotland":"Like St. Margaret, you use your position to serve the poor and reform society with charity.","St. Hildegard of Bingen":"Like St. Hildegard, you are a renaissance soul - combining mysticism, music, healing, and wisdom.","St. Kateri Tekakwitha":"Like St. Kateri, your faith blossoms beautifully despite persecution and hardship.","St. Josephine Bakhita":"Like St. Josephine, you have found freedom in Christ and live as a witness to His transforming grace."};return o[t.name]?n+=" "+o[t.name]:n+=` ${t.name} exemplifies these same qualities through their life of ${t.knownFor.toLowerCase()}. Their example can guide and inspire your own spiritual journey.`,n}async function revealResult(e){showScreen("userInfo");document.getElementById("userInfo").innerHTML='\n        <div class="ai-loading">\n            <div class="spinner"></div>\n            <p>Analyzing your spiritual journey with AI...</p>\n            <p style="font-size: 0.9em; color: #999; margin-top: 10px;">This may take a few moments</p>\n        </div>\n    ';try{calculateMatch(e);const t=[];userAnswers.forEach(e=>{t.push(...e.traits)});const i={};t.forEach(e=>{i[e]=(i[e]||0)+1});const a={},n=saintsDatabase.filter(t=>t.gender===e);n.forEach(e=>{e.traits.forEach(e=>{a[e]=(a[e]||0)+1})});const o=.4*n.length,s=Object.keys(a).filter(e=>a[e]>o),r=Object.entries(i).sort((e,t)=>t[1]-e[1]),c={};r.forEach(([e,t])=>{Object.keys(traitCategories).forEach(i=>{traitCategories[i].includes(e)&&(c[i]=(c[i]||0)+t)})});const h=Object.entries(c).sort((e,t)=>t[1]-e[1]).slice(0,3).map(([e])=>e),l=n.map(e=>{let t=0,a=0,n=0;e.traits.forEach(e=>{if(i[e]){const o=i[e],r=s.includes(e);t+=2*o*(r?1:2),a++,r||n++}}),e.traits.forEach(e=>{Object.keys(traitCategories).forEach(i=>{if(traitCategories[i].includes(e)&&h.includes(i)){const e=3-h.indexOf(i);t+=1.5*e}})}),a>=3&&(t+=1.5*a),n>0&&(t+=3*n);const o=a/e.traits.length;return o>.5&&(t+=5*o),{saint:e,score:t,directMatches:a,rareMatches:n}});l.sort((e,t)=>t.score-e.score);const u=l.slice(0,5);try{const t=new AbortController,a=setTimeout(()=>t.abort(),1e4),n=await fetch("/api/ai-match",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userAnswers:userAnswers,topCandidates:u.map(e=>({saint:{name:e.saint.name,knownFor:e.saint.knownFor,patronOf:e.saint.patronOf,dates:e.saint.dates||e.saint.lived},score:e.score})),userGender:e}),signal:t.signal});if(clearTimeout(a),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const o=await n.json();if(o.success&&o.saintName){const e=saintsDatabase.find(e=>e.name.toLowerCase().includes(o.saintName.toLowerCase())||o.saintName.toLowerCase().includes(e.name.toLowerCase()));e?(matchedSaint=e,matchExplanation=o.explanation||generateExplanation(i,matchedSaint),o.inspiration&&(matchExplanation+=" "+o.inspiration),console.log("✅ AI match successful:",matchedSaint.name)):console.warn("AI matched saint not found in database, using original match")}else console.warn("AI matching failed, using original algorithm")}catch(e){"AbortError"===e.name?console.warn("⏱️ AI request timed out after 10 seconds, using original algorithm"):console.error("AI matching error:",e)}}catch(t){console.error("Error in matching process:",t),matchedSaint||(console.warn("No match found, recalculating..."),calculateMatch(e))}displayResults()}function displayResults(){document.getElementById("resultSaintName").textContent=matchedSaint.name,document.getElementById("resultFeastDay").textContent=`Feast Day: ${matchedSaint.feastDay}`,document.getElementById("resultKnownFor").textContent=matchedSaint.knownFor,document.getElementById("resultPatronOf").textContent=matchedSaint.patronOf,document.getElementById("resultDates").textContent=matchedSaint.dates||matchedSaint.lived,document.getElementById("resultOrigin").textContent=matchedSaint.origin,document.getElementById("resultExplanation").textContent=matchExplanation,showScreen("results")}function retakeQuiz(){currentQuestion=0,userAnswers=[],matchedSaint=null,matchExplanation="",showScreen("landing")}function showScreen(e){document.querySelectorAll(".screen").forEach(e=>{e.classList.remove("active")}),document.getElementById(e).classList.add("active"),window.scrollTo(0,0)}document.addEventListener("DOMContentLoaded",()=>{initSaintOfTheDay()});